{"ast":null,"code":"import _toConsumableArray from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\Project\\\\stock_watcher_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import StockPriceForm from\"./StockPriceForm\";import AddStockIndexForm from\"./AddStockPriceForm\";var WatchBox=/*#__PURE__*/function(_Component){_inherits(WatchBox,_Component);function WatchBox(){var _getPrototypeOf2;var _this;_classCallCheck(this,WatchBox);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(WatchBox)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={url:\"https://stock-watcher-backend.herokuapp.com/users/alfredo\",watchedStocks:[]};_this.updateWatchedStocks=function(newStock){_this.setState(_objectSpread({},_this.state,{watchedStocks:[].concat(_toConsumableArray(_this.state.watchedStocks),[newStock])}),function(){_this.updateDatabase();});};_this.updateWatchedPrice=function(theStock){var oldValue=_this.state.watchedStocks.filter(function(el){return el.name===theStock.name;})[0];_this.setState(_objectSpread({},_this.state,{watchedStocks:[{name:theStock.name,priceLow:theStock.priceLow?theStock.priceLow:oldValue.priceLow,priceHigh:theStock.priceHigh?theStock.priceHigh:oldValue.priceHigh}].concat(_toConsumableArray(_this.state.watchedStocks.filter(function(el){return el.name!==theStock.name;})))}),function(){_this.updateDatabase();});};_this.deleteWatchedStock=function(name){_this.setState(_objectSpread({},_this.state,{watchedStocks:_this.state.watchedStocks.filter(function(el){return el.name!==name;})}),function(){_this.updateDatabase();});};_this.updateDatabase=function(){var myHeaders=new Headers();myHeaders.append(\"Content-Type\",\"application/json\");var myInit={method:\"POST\",headers:myHeaders,body:JSON.stringify(_this.state.watchedStocks)};var req=new Request(_this.state.url,myInit);fetch(req);};return _this;}_createClass(WatchBox,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var xhr=new XMLHttpRequest();xhr.open(\"GET\",this.state.url);xhr.send();try{xhr.addEventListener(\"load\",function(){var response=JSON.parse(xhr.response);_this2.setState(_objectSpread({},_this2.state,{watchedStocks:response.watchedStocks}));});}catch(_unused){console.log(\"error\");}}},{key:\"render\",value:function render(){var _this3=this;var watchedStocks=this.state.watchedStocks;return React.createElement(\"div\",{className:\"watch-box\"},React.createElement(\"h1\",null,\"WATCH BOX\"),React.createElement(AddStockIndexForm,{data:this.props.data,updateWatchedStocks:this.updateWatchedStocks,watchedStocks:this.state.watchedStocks}),React.createElement(\"ul\",null,watchedStocks.map(function(el){return React.createElement(\"li\",{key:el.name},React.createElement(StockPriceForm,{deleteWatchedStock:_this3.deleteWatchedStock,updateWatchedPrice:_this3.updateWatchedPrice,name:el.name,priceHigh:el.priceHigh,priceLow:el.priceLow}));})));}}]);return WatchBox;}(Component);export{WatchBox as default};","map":{"version":3,"sources":["D:/Project/stock_watcher_frontend/src/components/WatchBox.js"],"names":["React","Component","StockPriceForm","AddStockIndexForm","WatchBox","state","url","watchedStocks","updateWatchedStocks","newStock","setState","updateDatabase","updateWatchedPrice","theStock","oldValue","filter","el","name","priceLow","priceHigh","deleteWatchedStock","myHeaders","Headers","append","myInit","method","headers","body","JSON","stringify","req","Request","fetch","xhr","XMLHttpRequest","open","send","addEventListener","response","parse","console","log","props","data","map"],"mappings":"o2BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CAEA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,iBAAP,KAA8B,qBAA9B,C,GAEqBC,CAAAA,Q,uYACnBC,K,CAAQ,CACNC,GAAG,CAAE,2DADC,CAENC,aAAa,CAAE,EAFT,C,OAsBRC,mB,CAAsB,SAAAC,QAAQ,CAAI,CAChC,MAAKC,QAAL,kBAEO,MAAKL,KAFZ,EAGIE,aAAa,8BAAM,MAAKF,KAAL,CAAWE,aAAjB,GAAgCE,QAAhC,EAHjB,GAKE,UAAM,CACJ,MAAKE,cAAL,GACD,CAPH,EASD,C,OAEDC,kB,CAAqB,SAAAC,QAAQ,CAAI,CAC/B,GAAMC,CAAAA,QAAQ,CAAG,MAAKT,KAAL,CAAWE,aAAX,CAAyBQ,MAAzB,CACf,SAAAC,EAAE,QAAIA,CAAAA,EAAE,CAACC,IAAH,GAAYJ,QAAQ,CAACI,IAAzB,EADa,EAEf,CAFe,CAAjB,CAGA,MAAKP,QAAL,kBAEO,MAAKL,KAFZ,EAGIE,aAAa,EACX,CACEU,IAAI,CAAEJ,QAAQ,CAACI,IADjB,CAEEC,QAAQ,CAAEL,QAAQ,CAACK,QAAT,CAAoBL,QAAQ,CAACK,QAA7B,CAAwCJ,QAAQ,CAACI,QAF7D,CAGEC,SAAS,CAAEN,QAAQ,CAACM,SAAT,CACPN,QAAQ,CAACM,SADF,CAEPL,QAAQ,CAACK,SALf,CADW,4BAQR,MAAKd,KAAL,CAAWE,aAAX,CAAyBQ,MAAzB,CAAgC,SAAAC,EAAE,QAAIA,CAAAA,EAAE,CAACC,IAAH,GAAYJ,QAAQ,CAACI,IAAzB,EAAlC,CARQ,EAHjB,GAcE,UAAM,CACJ,MAAKN,cAAL,GACD,CAhBH,EAkBD,C,OAEDS,kB,CAAqB,SAAAH,IAAI,CAAI,CAC3B,MAAKP,QAAL,kBAEO,MAAKL,KAFZ,EAGIE,aAAa,CAAE,MAAKF,KAAL,CAAWE,aAAX,CAAyBQ,MAAzB,CAAgC,SAAAC,EAAE,QAAIA,CAAAA,EAAE,CAACC,IAAH,GAAYA,IAAhB,EAAlC,CAHnB,GAKE,UAAM,CACJ,MAAKN,cAAL,GACD,CAPH,EASD,C,OAEDA,c,CAAiB,UAAM,CACrB,GAAIU,CAAAA,SAAS,CAAG,GAAIC,CAAAA,OAAJ,EAAhB,CACAD,SAAS,CAACE,MAAV,CAAiB,cAAjB,CAAiC,kBAAjC,EACA,GAAIC,CAAAA,MAAM,CAAG,CACXC,MAAM,CAAE,MADG,CAEXC,OAAO,CAAEL,SAFE,CAGXM,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,MAAKxB,KAAL,CAAWE,aAA1B,CAHK,CAAb,CAKA,GAAMuB,CAAAA,GAAG,CAAG,GAAIC,CAAAA,OAAJ,CAAY,MAAK1B,KAAL,CAAWC,GAAvB,CAA4BkB,MAA5B,CAAZ,CACAQ,KAAK,CAACF,GAAD,CAAL,CACD,C,iGA3EmB,iBAClB,GAAMG,CAAAA,GAAG,CAAG,GAAIC,CAAAA,cAAJ,EAAZ,CACAD,GAAG,CAACE,IAAJ,CAAS,KAAT,CAAgB,KAAK9B,KAAL,CAAWC,GAA3B,EACA2B,GAAG,CAACG,IAAJ,GACA,GAAI,CACFH,GAAG,CAACI,gBAAJ,CAAqB,MAArB,CAA6B,UAAM,CACjC,GAAIC,CAAAA,QAAQ,CAAGV,IAAI,CAACW,KAAL,CAAWN,GAAG,CAACK,QAAf,CAAf,CACA,MAAI,CAAC5B,QAAL,kBACK,MAAI,CAACL,KADV,EAEEE,aAAa,CAAE+B,QAAQ,CAAC/B,aAF1B,IAID,CAND,EAOD,CAAC,cAAM,CACNiC,OAAO,CAACC,GAAR,CAAY,OAAZ,EACD,CACF,C,uCA8DQ,oBACClC,CAAAA,aADD,CACmB,KAAKF,KADxB,CACCE,aADD,CAEP,MACE,4BAAK,SAAS,CAAC,WAAf,EACE,0CADF,CAGE,oBAAC,iBAAD,EACE,IAAI,CAAE,KAAKmC,KAAL,CAAWC,IADnB,CAEE,mBAAmB,CAAE,KAAKnC,mBAF5B,CAGE,aAAa,CAAE,KAAKH,KAAL,CAAWE,aAH5B,EAHF,CASE,8BACGA,aAAa,CAACqC,GAAd,CAAkB,SAAA5B,EAAE,CAAI,CACvB,MACE,2BAAI,GAAG,CAAEA,EAAE,CAACC,IAAZ,EACE,oBAAC,cAAD,EACE,kBAAkB,CAAE,MAAI,CAACG,kBAD3B,CAEE,kBAAkB,CAAE,MAAI,CAACR,kBAF3B,CAGE,IAAI,CAAEI,EAAE,CAACC,IAHX,CAIE,SAAS,CAAED,EAAE,CAACG,SAJhB,CAKE,QAAQ,CAAEH,EAAE,CAACE,QALf,EADF,CADF,CAWD,CAZA,CADH,CATF,CADF,CA2BD,C,sBAhHmCjB,S,SAAjBG,Q","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport StockPriceForm from \"./StockPriceForm\";\r\nimport AddStockIndexForm from \"./AddStockPriceForm\";\r\n\r\nexport default class WatchBox extends Component {\r\n  state = {\r\n    url: \"https://stock-watcher-backend.herokuapp.com/users/alfredo\",\r\n    watchedStocks: []\r\n  };\r\n\r\n  componentDidMount() {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(\"GET\", this.state.url);\r\n    xhr.send();\r\n    try {\r\n      xhr.addEventListener(\"load\", () => {\r\n        var response = JSON.parse(xhr.response);\r\n        this.setState({\r\n          ...this.state,\r\n          watchedStocks: response.watchedStocks\r\n        });\r\n      });\r\n    } catch {\r\n      console.log(\"error\");\r\n    }\r\n  }\r\n\r\n  updateWatchedStocks = newStock => {\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        watchedStocks: [...this.state.watchedStocks, newStock]\r\n      },\r\n      () => {\r\n        this.updateDatabase();\r\n      }\r\n    );\r\n  };\r\n\r\n  updateWatchedPrice = theStock => {\r\n    const oldValue = this.state.watchedStocks.filter(\r\n      el => el.name === theStock.name\r\n    )[0];\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        watchedStocks: [\r\n          {\r\n            name: theStock.name,\r\n            priceLow: theStock.priceLow ? theStock.priceLow : oldValue.priceLow,\r\n            priceHigh: theStock.priceHigh\r\n              ? theStock.priceHigh\r\n              : oldValue.priceHigh\r\n          },\r\n          ...this.state.watchedStocks.filter(el => el.name !== theStock.name)\r\n        ]\r\n      },\r\n      () => {\r\n        this.updateDatabase();\r\n      }\r\n    );\r\n  };\r\n\r\n  deleteWatchedStock = name => {\r\n    this.setState(\r\n      {\r\n        ...this.state,\r\n        watchedStocks: this.state.watchedStocks.filter(el => el.name !== name)\r\n      },\r\n      () => {\r\n        this.updateDatabase();\r\n      }\r\n    );\r\n  };\r\n\r\n  updateDatabase = () => {\r\n    var myHeaders = new Headers();\r\n    myHeaders.append(\"Content-Type\", \"application/json\");\r\n    var myInit = {\r\n      method: \"POST\",\r\n      headers: myHeaders,\r\n      body: JSON.stringify(this.state.watchedStocks)\r\n    };\r\n    const req = new Request(this.state.url, myInit);\r\n    fetch(req);\r\n  };\r\n\r\n  render() {\r\n    const { watchedStocks } = this.state;\r\n    return (\r\n      <div className=\"watch-box\">\r\n        <h1>WATCH BOX</h1>\r\n\r\n        <AddStockIndexForm\r\n          data={this.props.data}\r\n          updateWatchedStocks={this.updateWatchedStocks}\r\n          watchedStocks={this.state.watchedStocks}\r\n        ></AddStockIndexForm>\r\n\r\n        <ul>\r\n          {watchedStocks.map(el => {\r\n            return (\r\n              <li key={el.name}>\r\n                <StockPriceForm\r\n                  deleteWatchedStock={this.deleteWatchedStock}\r\n                  updateWatchedPrice={this.updateWatchedPrice}\r\n                  name={el.name}\r\n                  priceHigh={el.priceHigh}\r\n                  priceLow={el.priceLow}\r\n                ></StockPriceForm>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}